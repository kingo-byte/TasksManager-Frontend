import{a as te,c as pe,d as ue,i as ke,j as ge,k as P}from"./chunk-NL2DGCQF.js";import{$a as Z,B as b,C as x,Cb as oe,Db as ne,E as v,Ea as H,Eb as re,Fa as d,Fb as se,G as N,Ga as J,Gb as ae,H as O,Ha as C,Ia as T,Ja as _,Jb as de,Ka as S,Kb as le,Lb as ce,M as m,Ma as V,Mb as me,N as p,Oa as z,Ob as B,Pa as K,Qa as Q,Qb as A,Wa as j,X as l,Y as u,_a as X,ab as $,cb as ee,db as F,fb as M,ha as E,ja as g,na as q,pa as R,qa as G,ra as n,sa as s,ta as y,ua as D,vb as Y,wa as f,wb as h,xa as I,xb as L,zb as ie}from"./chunk-VO6PPKUX.js";var W=(()=>{class t{constructor(e){this.http=e}getLookupByTableNames(e){return this.http.post(`${h.apiUrl}/api/Common/GetLookupByTableNames`,e)}static{this.\u0275fac=function(i){return new(i||t)(v(M))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var U=(()=>{class t{constructor(e){this.http=e}editTask(e){return this.http.post(`${h.apiUrl}/api/Task/EditTask`,e)}deleteTask(e){return this.http.post(`${h.apiUrl}/api/Task/DeleteTask`,e)}static{this.\u0275fac=function(i){return new(i||t)(v(M))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function we(t,k){if(t&1&&(n(0,"option",15),d(1),s()),t&2){let e=k.$implicit;g("value",e.code),l(),C(" ",e.description," ")}}function Ee(t,k){if(t&1&&(n(0,"option",15),d(1),s()),t&2){let e=k.$implicit;g("value",e.code),l(),C(" ",e.description," ")}}var ve=(()=>{class t{constructor(e,i,o,r,c){this.activeModal=e,this.commonService=i,this.taskService=o,this.authService=r,this.toastr=c,this.decodedToken=j(()=>this.authService.decodedToken()),this.statusOptions=[],this.categoryOptions=[]}ngOnInit(){if(this.getLookupByTableNames(),this.task.dueDate){let e=new Date(this.task.dueDate);this.dueDateModel={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}}submitForm(){this.task.title.trim()&&this.task.description.trim()&&this.task.statusCode&&this.task.categoryCode&&this.editTask()}getLookupByTableNames(){let e={tableNames:"TaskStatus,TaskCategory"};this.commonService.getLookupByTableNames(e).subscribe({next:i=>{this.statusOptions=i.lookups.TaskStatus,this.categoryOptions=i.lookups.TaskCategory},error:i=>{this.toastr.error(JSON.stringify(i),"An error has occured while getting drop downs")}})}editTask(){if(this.dueDateModel){let{year:i,month:o,day:r}=this.dueDateModel;this.task.dueDate=new Date(i,o-1,r).toISOString()}let e={task:this.task};this.taskService.editTask(e).subscribe({next:i=>{this.toastr.success("Task has been updated").onHidden.subscribe(()=>{this.activeModal.close()})},error:i=>{this.toastr.error(JSON.stringify(i),"An error has occured while adding a new task")}})}static{this.\u0275fac=function(i){return new(i||t)(u(ke),u(W),u(U),u(L),u(A))}}static{this.\u0275cmp=N({type:t,selectors:[["app-edit-task-modal"]],inputs:{task:"task"},standalone:!0,features:[V],decls:43,vars:6,consts:[["taskForm","ngForm"],["d","ngbDatepicker"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"mb-3"],["for","taskTitle",1,"form-label"],["type","text","id","taskTitle","name","title","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","taskDescription",1,"form-label"],["id","taskDescription","required","","name","description",1,"form-control",3,"ngModelChange","ngModel"],["for","select-status",1,"form-label"],["id","select-status","name","statusCode","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","select-category",1,"form-label"],["id","select-category","required","","name","categoryCode",1,"form-select",3,"ngModelChange","ngModel"],["for","input-DueDate",1,"form-label"],[1,"input-group"],["id","input-DueDate","placeholder","yyyy-mm-dd","name","dueDate","ngbDatepicker","",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],[1,"text-end"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(i,o){if(i&1){let r=D();n(0,"div",2)(1,"h4",3),d(2,"Add New Task"),s(),n(3,"button",4),f("click",function(){return m(r),p(o.activeModal.dismiss())}),s()(),n(4,"div",5)(5,"form",6,0),f("ngSubmit",function(){return m(r),p(o.submitForm())}),n(7,"div",7)(8,"label",8),d(9,"Title"),s(),n(10,"input",9),S("ngModelChange",function(a){return m(r),_(o.task.title,a)||(o.task.title=a),p(a)}),s()(),n(11,"div",7)(12,"label",10),d(13,"Description"),s(),n(14,"textarea",11),S("ngModelChange",function(a){return m(r),_(o.task.description,a)||(o.task.description=a),p(a)}),s()(),n(15,"div",7)(16,"label",12),d(17,"Status"),s(),n(18,"select",13),S("ngModelChange",function(a){return m(r),_(o.task.statusCode,a)||(o.task.statusCode=a),p(a)}),n(19,"option",14),d(20,"pick a status"),s(),R(21,we,2,2,"option",15,q),s()(),n(23,"div",7)(24,"label",16),d(25,"Category"),s(),n(26,"select",17),S("ngModelChange",function(a){return m(r),_(o.task.categoryCode,a)||(o.task.categoryCode=a),p(a)}),n(27,"option",14),d(28,"pick a category"),s(),R(29,Ee,2,2,"option",15,q),s()(),n(31,"div",7)(32,"label",18),d(33,"Due Date"),s(),n(34,"div",19)(35,"input",20,1),S("ngModelChange",function(a){return m(r),_(o.dueDateModel,a)||(o.dueDateModel=a),p(a)}),s(),n(37,"button",21),f("click",function(){m(r);let a=H(36);return p(a.toggle())}),s()()(),n(38,"div",22)(39,"button",23),f("click",function(){return m(r),p(o.activeModal.dismiss())}),d(40," Cancel "),s(),n(41,"button",24),d(42," Add Task "),s()()()()}if(i&2){let r=H(6);l(10),T("ngModel",o.task.title),l(4),T("ngModel",o.task.description),l(4),T("ngModel",o.task.statusCode),l(3),G(o.statusOptions),l(5),T("ngModel",o.task.categoryCode),l(3),G(o.categoryOptions),l(6),T("ngModel",o.dueDateModel),l(6),g("disabled",r.invalid)}},dependencies:[B,ae,le,ce,ie,de,oe,ne,me,se,re,P,ue,pe]})}}return t})();var ye=(()=>{class t{constructor(e){this.http=e}getUserTasks(e){return this.http.get(`${h.apiUrl}/api/User/${e}/Tasks`)}static{this.\u0275fac=function(i){return new(i||t)(v(M))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var Ie=(t,k,e)=>({"bg-success":t,"bg-warning text-dark":k,"bg-secondary":e});function xe(t,k){if(t&1){let e=D();n(0,"button",25),f("click",function(){m(e);let o=I().index,r=I();return p(r.markAsCompleted(o))}),y(1,"i",26),s()}}function Ne(t,k){if(t&1&&(n(0,"p",27),y(1,"i",28),d(2),K(3,"date"),s()),t&2){let e=I().$implicit;l(2),C(" ",Q(3,1,e.dueDate,"mediumDate")," ")}}function Oe(t,k){if(t&1){let e=D();n(0,"div",13)(1,"div",14)(2,"div",15),E(3,xe,2,0,"button",16),n(4,"button",17),f("click",function(){let o=m(e).index,r=I();return p(r.deleteTask(o))}),y(5,"i",18),s()(),n(6,"div",19)(7,"h5",20),d(8),s(),n(9,"p",21),d(10),s(),E(11,Ne,4,4,"p",22),n(12,"div",23)(13,"span",24),d(14),s()()()()()}if(t&2){let e=k.$implicit;l(3),g("ngIf",e.statusCode!=="COMPLETED"),l(5),J(e.title),l(2),J(e.description),l(),g("ngIf",e.dueDate),l(2),g("ngClass",z(6,Ie,e.statusCode==="COMPLETED",e.statusCode==="INPROGRESS",e.statusCode==="PENDING")),l(),C(" ",e.statusDescription," ")}}function Ve(t,k){t&1&&(n(0,"div",29)(1,"div",30),y(2,"i",31),n(3,"p",32),d(4,"You have no tasks"),s()()())}var Ce=(()=>{class t{constructor(e,i,o,r,c,a){this.modalService=e,this.commonService=i,this.userService=o,this.authService=r,this.taskService=c,this.toastr=a,this.tasks=[],this.statusOptions=[],this.decodedToken=j(()=>this.authService.decodedToken())}ngOnInit(){this.getLookupByTableNames(),this.getUserTasks()}editTask(e){let i=parseInt(this.decodedToken().UserId),o=this.modalService.open(ve),r=this.tasks.find(a=>a.id===e)??null,c={id:e!==-1?r.id:-1,userId:r?.userId??i,title:r?.title??"",description:r?.description??"",statusCode:r?.statusCode??"",categoryCode:r?.categoryCode??"",dueDate:r?.dueDate??""};o.componentInstance.task=c,o.result.then(a=>{this.getUserTasks()}).catch(a=>{})}markAsCompleted(e){let o={task:{id:this.tasks[e].id,userId:this.tasks[e].userId,title:this.tasks[e].title,description:this.tasks[e].description,statusCode:"COMPLETED",categoryCode:this.tasks[e].categoryCode,dueDate:this.tasks[e].dueDate}};this.taskService.editTask(o).subscribe({next:r=>{this.toastr.success("Task has been marked as completed").onHidden.subscribe(()=>{this.getUserTasks()})},error:r=>{this.toastr.error(JSON.stringify(r),"An error has occurred while updating task")}})}deleteTask(e){let i={taskId:this.tasks[e].id};this.taskService.deleteTask(i).subscribe({next:o=>{this.toastr.success("Task has been deleted").onHidden.subscribe(()=>{this.tasks.splice(e,1)})},error:o=>{this.toastr.error(JSON.stringify(o),"An error has occurred while deleting task")}})}getLookupByTableNames(){let e={tableNames:"TaskStatus"};this.commonService.getLookupByTableNames(e).subscribe({next:i=>{this.statusOptions=i.lookups.TaskStatus},error:i=>{this.toastr.error(JSON.stringify(i),"Error Getting Lookups")}})}getUserTasks(){let e=parseInt(this.decodedToken().UserId);this.userService.getUserTasks(e).subscribe({next:i=>{this.tasks=i.tasks?i.tasks:[]},error:i=>{this.toastr.error(JSON.stringify(i),"Error Getting Tasks")}})}static{this.\u0275fac=function(i){return new(i||t)(u(ge),u(W),u(ye),u(L),u(U),u(A))}}static{this.\u0275cmp=N({type:t,selectors:[["app-dashboard"]],standalone:!0,features:[V],decls:19,vars:2,consts:[[1,"container-fluid","router-content"],[1,"row"],[1,"col-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#",1,"text-decoration-none"],[1,"breadcrumb-item","active"],[1,"col-12","d-flex","justify-content-end"],["type","button","ngbTooltip","Click here to add a new task","aria-label","Add Tasks",1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-lg","me-1"],[1,"row","h-100","mt-4"],["class","col-md-4 mb-1",4,"ngFor","ngForOf"],["class","col-12 d-flex align-items-center justify-content-center",4,"ngIf"],[1,"col-md-4","mb-1"],[1,"card","shadow-sm","position-relative"],[1,"position-absolute","top-0","end-0","m-2","d-flex"],["class","btn btn-sm btn-success me-1","title","Mark as Completed",3,"click",4,"ngIf"],["title","Delete Task",1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text","flex-grow-1"],["class","card-text text-muted mb-1",4,"ngIf"],[1,"mt-2"],[1,"badge",3,"ngClass"],["title","Mark as Completed",1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"bi","bi-check-lg"],[1,"card-text","text-muted","mb-1"],[1,"bi","bi-calendar3","me-1"],[1,"col-12","d-flex","align-items-center","justify-content-center"],[1,"text-center"],[1,"bi","bi-clipboard-x",2,"font-size","2.5rem"],[1,"mt-3","text-muted"]],template:function(i,o){i&1&&(n(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),d(6,"Home"),s()(),n(7,"li",6),d(8,"Dashboard"),s()()(),n(9,"div",7)(10,"button",8),f("click",function(){return o.editTask(-1)}),y(11,"i",9),d(12," Add Tasks "),s()()(),n(13,"div",10)(14,"div",1)(15,"div",2)(16,"div",1),E(17,Oe,15,10,"div",11),s()()(),E(18,Ve,5,0,"div",12),s()()),i&2&&(l(17),g("ngForOf",o.tasks),l(),g("ngIf",o.tasks.length===0))},dependencies:[F,X,Z,$,ee,B,P],styles:[".card[_ngcontent-%COMP%]{position:relative;transition:transform .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.btn-success[_ngcontent-%COMP%]{opacity:.8}.btn-success[_ngcontent-%COMP%]:hover{opacity:1}"]})}}return t})();var je=[{path:"",component:Ce,canActivate:[te]}],Te=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=O({type:t})}static{this.\u0275inj=x({imports:[Y.forChild(je),Y]})}}return t})();var rt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275mod=O({type:t})}static{this.\u0275inj=x({imports:[F,Te]})}}return t})();export{rt as MainModule};
