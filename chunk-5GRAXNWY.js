import{a as ie,c as ue,d as ke,i as fe,j as he,k as L}from"./chunk-6VRKTSRC.js";import{Ab as g,B as b,Bb as P,C as x,Db as oe,E as v,Ea as H,Fa as l,G as N,Ga as $,Gb as re,H as j,Ha as C,Hb as ne,Ia as T,Ib as se,Ja as _,Jb as ae,Ka as M,Kb as de,M as m,Ma as O,N as p,Nb as le,Ob as ce,Pa as J,Pb as me,Qa as K,Qb as pe,Ra as Q,Tb as B,Vb as U,X as c,Xa as V,Y as u,bb as X,cb as Z,db as ee,fb as te,gb as F,ha as D,ib as S,ja as f,na as q,pa as R,qa as G,ra as n,sa as a,ta as y,ua as E,wa as h,xa as I,zb as Y}from"./chunk-CCNQPVDQ.js";var W=(()=>{class t{constructor(e){this.http=e}getLookupByTableNames(e){return this.http.post(`${g.apiUrl}/api/Common/GetLookupByTableNames`,e)}static{this.\u0275fac=function(o){return new(o||t)(v(S))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var A=(()=>{class t{constructor(e){this.http=e}editTask(e){return this.http.post(`${g.apiUrl}/api/Task/EditTask`,e)}deleteTask(e){return this.http.post(`${g.apiUrl}/api/Task/DeleteTask`,e)}static{this.\u0275fac=function(o){return new(o||t)(v(S))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function De(t,k){if(t&1&&(n(0,"option",15),l(1),a()),t&2){let e=k.$implicit;f("value",e.code),c(),C(" ",e.description," ")}}function Ee(t,k){if(t&1&&(n(0,"option",15),l(1),a()),t&2){let e=k.$implicit;f("value",e.code),c(),C(" ",e.description," ")}}var ye=(()=>{class t{constructor(e,o,i,r,d){this.activeModal=e,this.commonService=o,this.taskService=i,this.authService=r,this.toastr=d,this.decodedToken=V(()=>this.authService.decodedToken()),this.statusOptions=[],this.categoryOptions=[]}ngOnInit(){if(this.getLookupByTableNames(),this.task.dueDate){let e=new Date(this.task.dueDate);this.dueDateModel={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}}submitForm(){this.task.title.trim()&&this.task.description.trim()&&this.task.statusCode&&this.task.categoryCode&&this.editTask()}getLookupByTableNames(){let e={tableNames:"TaskStatus,TaskCategory"};this.commonService.getLookupByTableNames(e).subscribe({next:o=>{this.statusOptions=o.lookups.TaskStatus,this.categoryOptions=o.lookups.TaskCategory},error:o=>{let i=o.error.errors,r="";for(let d in i)i.hasOwnProperty(d)&&(r+=`${i[d].join(", ")}
`);this.toastr.error(r,o.error.title)}})}editTask(){if(this.dueDateModel){let{year:o,month:i,day:r}=this.dueDateModel;this.task.dueDate=new Date(Date.UTC(o,i-1,r)).toISOString()}let e={task:this.task};this.taskService.editTask(e).subscribe({next:o=>{this.toastr.success("New Task has been added"),this.activeModal.close()},error:o=>{let i=o.error.errors,r="";for(let d in i)i.hasOwnProperty(d)&&(r+=`${i[d].join(", ")}
`);this.toastr.error(r,o.error.title)}})}static{this.\u0275fac=function(o){return new(o||t)(u(fe),u(W),u(A),u(P),u(U))}}static{this.\u0275cmp=N({type:t,selectors:[["app-edit-task-modal"]],inputs:{task:"task"},standalone:!0,features:[O],decls:43,vars:6,consts:[["taskForm","ngForm"],["d","ngbDatepicker"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"mb-3"],["for","taskTitle",1,"form-label"],["type","text","id","taskTitle","name","title","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","taskDescription",1,"form-label"],["id","taskDescription","required","","name","description",1,"form-control",3,"ngModelChange","ngModel"],["for","select-status",1,"form-label"],["id","select-status","name","statusCode","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","select-category",1,"form-label"],["id","select-category","required","","name","categoryCode",1,"form-select",3,"ngModelChange","ngModel"],["for","input-DueDate",1,"form-label"],[1,"input-group"],["id","input-DueDate","placeholder","yyyy-mm-dd","name","dueDate","ngbDatepicker","",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],[1,"text-end"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(o,i){if(o&1){let r=E();n(0,"div",2)(1,"h4",3),l(2,"Add New Task"),a(),n(3,"button",4),h("click",function(){return m(r),p(i.activeModal.dismiss())}),a()(),n(4,"div",5)(5,"form",6,0),h("ngSubmit",function(){return m(r),p(i.submitForm())}),n(7,"div",7)(8,"label",8),l(9,"Title"),a(),n(10,"input",9),M("ngModelChange",function(s){return m(r),_(i.task.title,s)||(i.task.title=s),p(s)}),a()(),n(11,"div",7)(12,"label",10),l(13,"Description"),a(),n(14,"textarea",11),M("ngModelChange",function(s){return m(r),_(i.task.description,s)||(i.task.description=s),p(s)}),a()(),n(15,"div",7)(16,"label",12),l(17,"Status"),a(),n(18,"select",13),M("ngModelChange",function(s){return m(r),_(i.task.statusCode,s)||(i.task.statusCode=s),p(s)}),n(19,"option",14),l(20,"pick a status"),a(),R(21,De,2,2,"option",15,q),a()(),n(23,"div",7)(24,"label",16),l(25,"Category"),a(),n(26,"select",17),M("ngModelChange",function(s){return m(r),_(i.task.categoryCode,s)||(i.task.categoryCode=s),p(s)}),n(27,"option",14),l(28,"pick a category"),a(),R(29,Ee,2,2,"option",15,q),a()(),n(31,"div",7)(32,"label",18),l(33,"Due Date"),a(),n(34,"div",19)(35,"input",20,1),M("ngModelChange",function(s){return m(r),_(i.dueDateModel,s)||(i.dueDateModel=s),p(s)}),a(),n(37,"button",21),h("click",function(){m(r);let s=H(36);return p(s.toggle())}),a()()(),n(38,"div",22)(39,"button",23),h("click",function(){return m(r),p(i.activeModal.dismiss())}),l(40," Cancel "),a(),n(41,"button",24),l(42," Add Task "),a()()()()}if(o&2){let r=H(6);c(10),T("ngModel",i.task.title),c(4),T("ngModel",i.task.description),c(4),T("ngModel",i.task.statusCode),c(3),G(i.statusOptions),c(5),T("ngModel",i.task.categoryCode),c(3),G(i.categoryOptions),c(6),T("ngModel",i.dueDateModel),c(6),f("disabled",r.invalid)}},dependencies:[B,de,ce,me,oe,le,re,ne,pe,ae,se,L,ke,ue]})}}return t})();var Ce=(()=>{class t{constructor(e){this.http=e}getUserTasks(e){return this.http.get(`${g.apiUrl}/api/User/${e}/Tasks`)}static{this.\u0275fac=function(o){return new(o||t)(v(S))}}static{this.\u0275prov=b({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var xe=(t,k,e)=>({"bg-success":t,"bg-warning text-dark":k,"bg-secondary":e});function Ne(t,k){if(t&1){let e=E();n(0,"button",25),h("click",function(){m(e);let i=I().index,r=I();return p(r.markAsCompleted(i))}),y(1,"i",26),a()}}function je(t,k){if(t&1&&(n(0,"p",27),y(1,"i",28),l(2),K(3,"date"),a()),t&2){let e=I().$implicit;c(2),C(" ",Q(3,1,e.dueDate,"mediumDate")," ")}}function Oe(t,k){if(t&1){let e=E();n(0,"div",13)(1,"div",14)(2,"div",15),D(3,Ne,2,0,"button",16),n(4,"button",17),h("click",function(){let i=m(e).index,r=I();return p(r.deleteTask(i))}),y(5,"i",18),a()(),n(6,"div",19)(7,"h5",20),l(8),a(),n(9,"p",21),l(10),a(),D(11,je,4,4,"p",22),n(12,"div",23)(13,"span",24),l(14),a()()()()()}if(t&2){let e=k.$implicit;c(3),f("ngIf",e.statusCode!=="COMPLETED"),c(5),$(e.title),c(2),$(e.description),c(),f("ngIf",e.dueDate),c(2),f("ngClass",J(6,xe,e.statusCode==="COMPLETED",e.statusCode==="INPROGRESS",e.statusCode==="PENDING")),c(),C(" ",e.statusDescription," ")}}function Ve(t,k){t&1&&(n(0,"div",29)(1,"div",30),y(2,"i",31),n(3,"p",32),l(4,"You have no tasks"),a()()())}var Te=(()=>{class t{constructor(e,o,i,r,d,s){this.modalService=e,this.commonService=o,this.userService=i,this.authService=r,this.taskService=d,this.toastr=s,this.tasks=[],this.statusOptions=[],this.decodedToken=V(()=>this.authService.decodedToken())}ngOnInit(){this.getLookupByTableNames(),this.getUserTasks()}editTask(e){let o=parseInt(this.decodedToken().UserId),i=this.modalService.open(ye),r=this.tasks.find(s=>s.id===e)??null,d={id:e!==-1?r.id:-1,userId:r?.userId??o,title:r?.title??"",description:r?.description??"",statusCode:r?.statusCode??"",categoryCode:r?.categoryCode??"",dueDate:r?.dueDate??""};i.componentInstance.task=d,i.result.then(s=>{this.getUserTasks()}).catch(s=>{})}markAsCompleted(e){let i={task:{id:this.tasks[e].id,userId:this.tasks[e].userId,title:this.tasks[e].title,description:this.tasks[e].description,statusCode:"COMPLETED",categoryCode:this.tasks[e].categoryCode,dueDate:this.tasks[e].dueDate}};this.taskService.editTask(i).subscribe({next:r=>{this.toastr.success("Task has been marked as completed"),this.getUserTasks()},error:r=>{let d=r.error.errors,s="";for(let z in d)d.hasOwnProperty(z)&&(s+=`${d[z].join(", ")}
`);this.toastr.error(s,r.error.title)}})}deleteTask(e){let o={taskId:this.tasks[e].id};this.taskService.deleteTask(o).subscribe({next:i=>{this.toastr.success("Task has been deleted"),this.tasks.splice(e,1)},error:i=>{let r=i.error.errors,d="";for(let s in r)r.hasOwnProperty(s)&&(d+=`${r[s].join(", ")}
`);this.toastr.error(d,i.error.title)}})}getLookupByTableNames(){let e={tableNames:"TaskStatus"};this.commonService.getLookupByTableNames(e).subscribe({next:o=>{this.statusOptions=o.lookups.TaskStatus},error:o=>{let i=o.error.errors,r="";for(let d in i)i.hasOwnProperty(d)&&(r+=`${i[d].join(", ")}
`);this.toastr.error(r,o.error.title)}})}getUserTasks(){let e=parseInt(this.decodedToken().UserId);this.userService.getUserTasks(e).subscribe({next:o=>{this.tasks=o.tasks?o.tasks:[]},error:o=>{this.toastr.error(JSON.stringify(o),"Error Getting Tasks")}})}static{this.\u0275fac=function(o){return new(o||t)(u(he),u(W),u(Ce),u(P),u(A),u(U))}}static{this.\u0275cmp=N({type:t,selectors:[["app-dashboard"]],standalone:!0,features:[O],decls:19,vars:2,consts:[[1,"container-fluid","router-content"],[1,"row"],[1,"col-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#",1,"text-decoration-none"],[1,"breadcrumb-item","active"],[1,"col-12","d-flex","justify-content-end"],["type","button","ngbTooltip","Click here to add a new task","aria-label","Add Tasks",1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-lg","me-1"],[1,"row","h-100","mt-4"],["class","col-md-4 mb-1",4,"ngFor","ngForOf"],["class","col-12 d-flex align-items-center justify-content-center",4,"ngIf"],[1,"col-md-4","mb-1"],[1,"card","shadow-sm","position-relative"],[1,"position-absolute","top-0","end-0","m-2","d-flex"],["class","btn btn-sm btn-success me-1","title","Mark as Completed",3,"click",4,"ngIf"],["title","Delete Task",1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text","flex-grow-1"],["class","card-text text-muted mb-1",4,"ngIf"],[1,"mt-2"],[1,"badge",3,"ngClass"],["title","Mark as Completed",1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"bi","bi-check-lg"],[1,"card-text","text-muted","mb-1"],[1,"bi","bi-calendar3","me-1"],[1,"col-12","d-flex","align-items-center","justify-content-center"],[1,"text-center"],[1,"bi","bi-clipboard-x",2,"font-size","2.5rem"],[1,"mt-3","text-muted"]],template:function(o,i){o&1&&(n(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),l(6,"Home"),a()(),n(7,"li",6),l(8,"Dashboard"),a()()(),n(9,"div",7)(10,"button",8),h("click",function(){return i.editTask(-1)}),y(11,"i",9),l(12," Add Tasks "),a()()(),n(13,"div",10)(14,"div",1)(15,"div",2)(16,"div",1),D(17,Oe,15,10,"div",11),a()()(),D(18,Ve,5,0,"div",12),a()()),o&2&&(c(17),f("ngForOf",i.tasks),c(),f("ngIf",i.tasks.length===0))},dependencies:[F,X,Z,ee,te,B,L],styles:[".card[_ngcontent-%COMP%]{position:relative;transition:transform .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.btn-success[_ngcontent-%COMP%]{opacity:.8}.btn-success[_ngcontent-%COMP%]:hover{opacity:1}"]})}}return t})();var Fe=[{path:"",component:Te,canActivate:[ie],pathMatch:"full"},{path:"**",redirectTo:""}],_e=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=j({type:t})}static{this.\u0275inj=x({imports:[Y.forChild(Fe),Y]})}}return t})();var st=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=j({type:t})}static{this.\u0275inj=x({imports:[F,_e]})}}return t})();export{st as MainModule};
