import{a as ie,c as ue,d as ke,i as fe,j as he,k as L}from"./chunk-6VRKTSRC.js";import{Ab as g,B as b,Bb as P,C as x,Db as oe,E as y,Ea as $,Fa as d,G as j,Ga as H,Gb as re,H as N,Ha as C,Hb as ne,Ia as T,Ib as se,Ja as _,Jb as ae,Ka as M,Kb as le,M as m,Ma as O,N as p,Nb as de,Ob as ce,Pa as J,Pb as me,Qa as K,Qb as pe,Ra as Q,Tb as B,Vb as U,X as c,Xa as V,Y as u,bb as X,cb as Z,db as ee,fb as te,gb as F,ha as D,ib as S,ja as f,na as q,pa as R,qa as G,ra as n,sa as l,ta as v,ua as E,wa as h,xa as I,zb as Y}from"./chunk-CCNQPVDQ.js";var W=(()=>{class i{constructor(e){this.http=e}getLookupByTableNames(e){return this.http.post(`${g.apiUrl}/api/Common/GetLookupByTableNames`,e)}static{this.\u0275fac=function(o){return new(o||i)(y(S))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var A=(()=>{class i{constructor(e){this.http=e}editTask(e){return this.http.post(`${g.apiUrl}/api/Task/EditTask`,e)}deleteTask(e){return this.http.post(`${g.apiUrl}/api/Task/DeleteTask`,e)}static{this.\u0275fac=function(o){return new(o||i)(y(S))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();function De(i,k){if(i&1&&(n(0,"option",15),d(1),l()),i&2){let e=k.$implicit;f("value",e.code),c(),C(" ",e.description," ")}}function Ee(i,k){if(i&1&&(n(0,"option",15),d(1),l()),i&2){let e=k.$implicit;f("value",e.code),c(),C(" ",e.description," ")}}var ve=(()=>{class i{constructor(e,o,t,r,s){this.activeModal=e,this.commonService=o,this.taskService=t,this.authService=r,this.toastr=s,this.decodedToken=V(()=>this.authService.decodedToken()),this.statusOptions=[],this.categoryOptions=[]}ngOnInit(){if(this.getLookupByTableNames(),this.task.dueDate){let e=new Date(this.task.dueDate);this.dueDateModel={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()}}}submitForm(){this.task.title.trim()&&this.task.description.trim()&&this.task.statusCode&&this.task.categoryCode&&this.editTask()}getLookupByTableNames(){let e={tableNames:"TaskStatus,TaskCategory"};this.commonService.getLookupByTableNames(e).subscribe({next:o=>{this.statusOptions=o.lookups.TaskStatus,this.categoryOptions=o.lookups.TaskCategory},error:o=>{let t=o.error.errors,r="";for(let s in t)t.hasOwnProperty(s)&&(r+=`${t[s].join(", ")}
`);this.toastr.error(r,o.error.title)}})}editTask(){if(this.dueDateModel){let{year:o,month:t,day:r}=this.dueDateModel;this.task.dueDate=new Date(Date.UTC(o,t-1,r)).toISOString()}let e={task:this.task};this.taskService.editTask(e).subscribe({next:o=>{this.toastr.success("New Task has been added"),this.activeModal.close()},error:o=>{let t=o.error.errors,r="";for(let s in t)t.hasOwnProperty(s)&&(r+=`${t[s].join(", ")}
`);this.toastr.error(r,o.error.title)}})}static{this.\u0275fac=function(o){return new(o||i)(u(fe),u(W),u(A),u(P),u(U))}}static{this.\u0275cmp=j({type:i,selectors:[["app-edit-task-modal"]],inputs:{task:"task"},standalone:!0,features:[O],decls:43,vars:6,consts:[["taskForm","ngForm"],["d","ngbDatepicker"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"mb-3"],["for","taskTitle",1,"form-label"],["type","text","id","taskTitle","name","title","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","taskDescription",1,"form-label"],["id","taskDescription","required","","name","description",1,"form-control",3,"ngModelChange","ngModel"],["for","select-status",1,"form-label"],["id","select-status","name","statusCode","required","",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["for","select-category",1,"form-label"],["id","select-category","required","","name","categoryCode",1,"form-select",3,"ngModelChange","ngModel"],["for","input-DueDate",1,"form-label"],[1,"input-group"],["id","input-DueDate","placeholder","yyyy-mm-dd","name","dueDate","ngbDatepicker","",1,"form-control",3,"ngModelChange","ngModel"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],[1,"text-end"],["type","button",1,"btn","btn-secondary","me-2",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"]],template:function(o,t){if(o&1){let r=E();n(0,"div",2)(1,"h4",3),d(2,"Add New Task"),l(),n(3,"button",4),h("click",function(){return m(r),p(t.activeModal.dismiss())}),l()(),n(4,"div",5)(5,"form",6,0),h("ngSubmit",function(){return m(r),p(t.submitForm())}),n(7,"div",7)(8,"label",8),d(9,"Title"),l(),n(10,"input",9),M("ngModelChange",function(a){return m(r),_(t.task.title,a)||(t.task.title=a),p(a)}),l()(),n(11,"div",7)(12,"label",10),d(13,"Description"),l(),n(14,"textarea",11),M("ngModelChange",function(a){return m(r),_(t.task.description,a)||(t.task.description=a),p(a)}),l()(),n(15,"div",7)(16,"label",12),d(17,"Status"),l(),n(18,"select",13),M("ngModelChange",function(a){return m(r),_(t.task.statusCode,a)||(t.task.statusCode=a),p(a)}),n(19,"option",14),d(20,"pick a status"),l(),R(21,De,2,2,"option",15,q),l()(),n(23,"div",7)(24,"label",16),d(25,"Category"),l(),n(26,"select",17),M("ngModelChange",function(a){return m(r),_(t.task.categoryCode,a)||(t.task.categoryCode=a),p(a)}),n(27,"option",14),d(28,"pick a category"),l(),R(29,Ee,2,2,"option",15,q),l()(),n(31,"div",7)(32,"label",18),d(33,"Due Date"),l(),n(34,"div",19)(35,"input",20,1),M("ngModelChange",function(a){return m(r),_(t.dueDateModel,a)||(t.dueDateModel=a),p(a)}),l(),n(37,"button",21),h("click",function(){m(r);let a=$(36);return p(a.toggle())}),l()()(),n(38,"div",22)(39,"button",23),h("click",function(){return m(r),p(t.activeModal.dismiss())}),d(40," Cancel "),l(),n(41,"button",24),d(42," Add Task "),l()()()()}if(o&2){let r=$(6);c(10),T("ngModel",t.task.title),c(4),T("ngModel",t.task.description),c(4),T("ngModel",t.task.statusCode),c(3),G(t.statusOptions),c(5),T("ngModel",t.task.categoryCode),c(3),G(t.categoryOptions),c(6),T("ngModel",t.dueDateModel),c(6),f("disabled",r.invalid)}},dependencies:[B,le,ce,me,oe,de,re,ne,pe,ae,se,L,ke,ue]})}}return i})();var Ce=(()=>{class i{constructor(e){this.http=e}getUserTasks(e){return this.http.get(`${g.apiUrl}/api/User/${e}/Tasks`)}static{this.\u0275fac=function(o){return new(o||i)(y(S))}}static{this.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var xe=(i,k,e)=>({"bg-success":i,"bg-warning text-dark":k,"bg-secondary":e});function je(i,k){if(i&1){let e=E();n(0,"button",25),h("click",function(){m(e);let t=I().index,r=I();return p(r.markAsCompleted(t))}),v(1,"i",26),l()}}function Ne(i,k){if(i&1&&(n(0,"p",27),v(1,"i",28),d(2),K(3,"date"),l()),i&2){let e=I().$implicit;c(2),C(" ",Q(3,1,e.dueDate,"mediumDate")," ")}}function Oe(i,k){if(i&1){let e=E();n(0,"div",13)(1,"div",14)(2,"div",15),D(3,je,2,0,"button",16),n(4,"button",17),h("click",function(){let t=m(e).index,r=I();return p(r.deleteTask(t))}),v(5,"i",18),l()(),n(6,"div",19)(7,"h5",20),d(8),l(),n(9,"p",21),d(10),l(),D(11,Ne,4,4,"p",22),n(12,"div",23)(13,"span",24),d(14),l()()()()()}if(i&2){let e=k.$implicit;c(3),f("ngIf",e.statusCode!=="COMPLETED"),c(5),H(e.title),c(2),H(e.description),c(),f("ngIf",e.dueDate),c(2),f("ngClass",J(6,xe,e.statusCode==="COMPLETED",e.statusCode==="INPROGRESS",e.statusCode==="PENDING")),c(),C(" ",e.statusDescription," ")}}function Ve(i,k){i&1&&(n(0,"div",29)(1,"div",30),v(2,"i",31),n(3,"p",32),d(4,"You have no tasks"),l()()())}var Te=(()=>{class i{constructor(e,o,t,r,s,a){this.modalService=e,this.commonService=o,this.userService=t,this.authService=r,this.taskService=s,this.toastr=a,this.tasks=[],this.statusOptions=[],this.decodedToken=V(()=>this.authService.decodedToken())}ngOnInit(){this.getLookupByTableNames(),this.getUserTasks()}editTask(e){let o=parseInt(this.decodedToken().UserId),t=this.modalService.open(ve),r=this.tasks.find(a=>a.id===e)??null,s={id:e!==-1?r.id:-1,userId:r?.userId??o,title:r?.title??"",description:r?.description??"",statusCode:r?.statusCode??"",categoryCode:r?.categoryCode??"",dueDate:r?.dueDate??""};t.componentInstance.task=s,t.result.then(a=>{this.getUserTasks()}).catch(a=>{})}markAsCompleted(e){let t={task:{id:this.tasks[e].id,userId:this.tasks[e].userId,title:this.tasks[e].title,description:this.tasks[e].description,statusCode:"COMPLETED",categoryCode:this.tasks[e].categoryCode,dueDate:this.tasks[e].dueDate}};this.taskService.editTask(t).subscribe({next:r=>{this.toastr.success("Task has been marked as completed"),this.getUserTasks()},error:r=>{let s=r.error.errors,a="";for(let z in s)s.hasOwnProperty(z)&&(a+=`${s[z].join(", ")}
`);this.toastr.error(a,r.error.title)}})}deleteTask(e){let o={taskId:this.tasks[e].id};this.taskService.deleteTask(o).subscribe({next:t=>{this.toastr.success("Task has been deleted"),this.tasks.splice(e,1)},error:t=>{let r=t.error.errors,s="";for(let a in r)r.hasOwnProperty(a)&&(s+=`${r[a].join(", ")}
`);this.toastr.error(s,t.error.title)}})}getLookupByTableNames(){let e={tableNames:"TaskStatus"};this.commonService.getLookupByTableNames(e).subscribe({next:o=>{this.statusOptions=o.lookups.TaskStatus},error:o=>{let t=o.error.errors,r="";for(let s in t)t.hasOwnProperty(s)&&(r+=`${t[s].join(", ")}
`);this.toastr.error(r,o.error.title)}})}getUserTasks(){let e=parseInt(this.decodedToken().UserId);this.userService.getUserTasks(e).subscribe({next:o=>{this.tasks=o.tasks?o.tasks:[]},error:o=>{let t=o.error.errors,r="";for(let s in t)t.hasOwnProperty(s)&&(r+=`${t[s].join(", ")}
`);this.toastr.error(r,o.error.title)}})}static{this.\u0275fac=function(o){return new(o||i)(u(he),u(W),u(Ce),u(P),u(A),u(U))}}static{this.\u0275cmp=j({type:i,selectors:[["app-dashboard"]],standalone:!0,features:[O],decls:19,vars:2,consts:[[1,"container-fluid","router-content"],[1,"row"],[1,"col-12"],[1,"breadcrumb"],[1,"breadcrumb-item"],["href","#",1,"text-decoration-none"],[1,"breadcrumb-item","active"],[1,"col-12","d-flex","justify-content-end"],["type","button","ngbTooltip","Click here to add a new task","aria-label","Add Tasks",1,"btn","btn-primary",3,"click"],[1,"bi","bi-plus-lg","me-1"],[1,"row","h-100","mt-4"],["class","col-md-4 mb-1",4,"ngFor","ngForOf"],["class","col-12 d-flex align-items-center justify-content-center",4,"ngIf"],[1,"col-md-4","mb-1"],[1,"card","shadow-sm","position-relative"],[1,"position-absolute","top-0","end-0","m-2","d-flex"],["class","btn btn-sm btn-success me-1","title","Mark as Completed",3,"click",4,"ngIf"],["title","Delete Task",1,"btn","btn-sm","btn-danger",3,"click"],[1,"bi","bi-trash"],[1,"card-body","d-flex","flex-column"],[1,"card-title"],[1,"card-text","flex-grow-1"],["class","card-text text-muted mb-1",4,"ngIf"],[1,"mt-2"],[1,"badge",3,"ngClass"],["title","Mark as Completed",1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"bi","bi-check-lg"],[1,"card-text","text-muted","mb-1"],[1,"bi","bi-calendar3","me-1"],[1,"col-12","d-flex","align-items-center","justify-content-center"],[1,"text-center"],[1,"bi","bi-clipboard-x",2,"font-size","2.5rem"],[1,"mt-3","text-muted"]],template:function(o,t){o&1&&(n(0,"div",0)(1,"div",1)(2,"nav",2)(3,"ol",3)(4,"li",4)(5,"a",5),d(6,"Home"),l()(),n(7,"li",6),d(8,"Dashboard"),l()()(),n(9,"div",7)(10,"button",8),h("click",function(){return t.editTask(-1)}),v(11,"i",9),d(12," Add Tasks "),l()()(),n(13,"div",10)(14,"div",1)(15,"div",2)(16,"div",1),D(17,Oe,15,10,"div",11),l()()(),D(18,Ve,5,0,"div",12),l()()),o&2&&(c(17),f("ngForOf",t.tasks),c(),f("ngIf",t.tasks.length===0))},dependencies:[F,X,Z,ee,te,B,L],styles:[".card[_ngcontent-%COMP%]{position:relative;transition:transform .2s}.card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.btn-success[_ngcontent-%COMP%]{opacity:.8}.btn-success[_ngcontent-%COMP%]:hover{opacity:1}"]})}}return i})();var Fe=[{path:"",component:Te,canActivate:[ie],pathMatch:"full"},{path:"**",redirectTo:""}],_e=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=N({type:i})}static{this.\u0275inj=x({imports:[Y.forChild(Fe),Y]})}}return i})();var st=(()=>{class i{static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275mod=N({type:i})}static{this.\u0275inj=x({imports:[F,_e]})}}return i})();export{st as MainModule};
